<div id="tablettab" class="tabcontent tablettab">
  <div id="tablet-listener">
    <div class = "maslow">
      <div class = "display tablettab-canvas-wrapper" >
        <canvas id="small-toolpath" class="previewer" style="width: 100%; height: 100%"></canvas>
        <textarea style="border:  none" class="gcode" id="gcode" rows="8" placeholder="GCode File Display" spellcheck="false" readonly>
        </textarea>
      </div>
      <div class = "tablettab-controls-wrapper">
        <div style="grid-template-columns: 20% 20% 20% 20% 20%;" class="maslow-grid-container tablettab-controls-item">
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;; color: #337ab7"
            onclick="sendMove('Z+');" id="zUp">
            <svg width="32" height="32" viewBox="0 0 38 38">
              <polygon fill="currentColor" points="10.319 5.525 17.833 13.039 2.805 13.039 10.319 5.525" />
              <rect fill="currentColor" height="2.5" transform="translate(31.899 11.262) rotate(90)" width="21.79" x="-0.576" y="20.33" />
            </svg>
            Z
          </div>
          <div class="maslow-grid-item maslow-grid-item-btn" onclick="sendMove('X-Y+')" style="background-color: #b69fcb;"><canvas id="tlBtn" style="width: 100%; height: 100%"></canvas></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #9d88c0;" onclick="sendMove('Y+')"><canvas id="upBtn" style="width: 100%; height: 100%"></canvas></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #b69fcb;" onclick="sendMove('X+Y+')"><canvas id="trBtn" style="width: 100%; height: 100%"></canvas></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4; font-size: 1vw; color: #337ab7; display: flex;flex-direction: column;"
            onclick="loadCornerValues(); openModal('calibration-popup');" id="calibrationBTN" >
            <svg height="32" width="32" viewBox="0 0 48 48" fill="currentColor">
              <g>
                <path d="M24,11c-7.2,0-13,5.8-13,13c0,7.2,5.8,13,13,13c7.2,0,13-5.8,13-13C37,16.8,31.2,11,24,11z M24,35c-6.1,0-11-4.9-11-11   s4.9-11,11-11s11,4.9,11,11S30.1,35,24,35z" />
                <path d="M44,20h-2.4c-0.5-2.1-1.3-4-2.3-5.6l1.6-1.8c1.2-1.2,1.2-3,0-4.2L39.5,7c-1.2-1.2-3.1-1.2-4.2,0l-1.8,1.8   c-1.8-1.2-3.6-1.9-5.6-2.3V4c0-1.7-1.3-3-3-3h-2c-1.7,0-3,1.3-3,3v2.5c-1.9,0.4-3.8,1.2-5.6,2.3l-1.7-1.7c-1.2-1.2-3-1.2-4.2,0   L7,8.5c-0.6,0.6-0.9,1.3-0.9,2.1s0.3,1.5,0.9,2.1l1.8,1.7c-1.1,1.8-1.9,3.6-2.3,5.6H4c-1.7,0-3,1.3-3,3v2c0,1.7,1.3,3,3,3h2.5   c0.4,1.9,1.2,3.8,2.4,5.6l-1.7,1.8c-1.2,1.2-1.2,3,0,4.2L8.5,41c1.2,1.2,3,1.2,4.2,0l1.7-1.8c1.8,1.1,3.6,1.9,5.6,2.3V44   c0,1.7,1.3,3,3,3h2c1.7,0,3-1.3,3-3v-2.4c2.1-0.5,3.9-1.3,5.6-2.3l1.7,1.6c1.2,1.2,3,1.2,4.2,0l1.4-1.4c1.2-1.2,1.2-3,0-4.2   l-1.7-1.7c1.2-1.8,1.9-3.6,2.3-5.6H44c1.7,0,3-1.3,3-3v-2C47,21.3,45.7,20,44,20z M45,25c0,0.6-0.4,1-1,1h-4.2l-0.1,0.8   c-0.4,2.2-1.2,4.3-2.6,6.3l-0.5,0.7l2.9,2.9c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-1.4,1.4c-0.4,0.4-1,0.4-1.4,0   l-2.9-2.8l-0.7,0.5c-1.8,1.3-3.9,2.2-6.3,2.6L26,40v4c0,0.6-0.4,1-1,1h-2c-0.6,0-1-0.4-1-1v-4.2l-0.8-0.1c-2.2-0.4-4.3-1.2-6.3-2.6   l-0.7-0.5l-2.9,3c-0.4,0.4-1,0.4-1.4,0l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4l2.9-3l-0.5-0.7c-1.4-2-2.3-4.1-2.6-6.3L8.2,26H4   c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1h4.2l0.1-0.8c0.4-2.2,1.2-4.3,2.6-6.3l0.5-0.7l-3-2.9c-0.2-0.2-0.3-0.4-0.3-0.7   s0.1-0.5,0.3-0.7l1.4-1.4c0.4-0.4,1-0.4,1.4,0l2.9,2.9l0.7-0.5c1.9-1.4,4.1-2.3,6.3-2.6l0.8-0.1V4c0-0.6,0.4-1,1-1h2   c0.6,0,1,0.4,1,1v4.2l0.8,0.1c2.2,0.4,4.3,1.2,6.3,2.6l0.7,0.5l3-3c0.4-0.4,1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4l-2.7,3   l0.5,0.7c1.2,1.8,2.1,3.9,2.6,6.3L40,22h4c0.6,0,1,0.4,1,1V25z" />
              </g>
            </svg>
            <span>Setup</span>
          </div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;; color: #337ab7"
            onclick="sendMove('Z-');" id="zDown">
            <svg width="32" height="32" viewBox="0 0 38 38">
              <polygon fill="currentColor" points="27.681 32.475 35.195 24.961 20.167 24.961 27.681 32.475" />
              <rect fill="currentColor" height="2.5" transform="translate(11.262 44.101) rotate(-90)" width="21.79" x="16.786" y="15.17" />
            </svg>
            Z
          </div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #9d88c0;" onclick="sendMove('X-')"><canvas id="lBtn" style="width: 100%; height: 100%"></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;" onclick="moveHome()"><canvas id="hBtn" style="width: 100%; height: 100%"></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #9d88c0;" onclick="sendMove('X+')"><canvas id="rBtn" style="width: 100%; height: 100%"></div>
          <div class="maslow-grid-item maslow-grid-item-btn"></div>

          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;"
            onmousedown="zeroAxis('Z');" onmouseup="refreshGcode();">Define Z Home</div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #b69fcb;" onclick="sendMove('X-Y-')"> <canvas id="blBtn" style="width: 100%; height: 100%"></canvas> </div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #9d88c0;" onclick="sendMove('Y-')"><canvas id="dnBtn" style="width: 100%; height: 100%"></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #b69fcb;" onclick="sendMove('X+Y-')"> <canvas id="brBtn" style="width: 100%; height: 100%"></canvas> </div>
          <div class="maslow-grid-item maslow-grid-item-btn"></div>
          
          <div class="maslow-grid-item maslow-grid-item-btn">Dist To Move:</div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;" id="disM">100</div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;" id="units" title="Toggle Units"
            onclick="toggleUnits()">mm</div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #f2f0e4;"
            onmousedown="zeroAxis('X');zeroAxis('Y');" onmouseup="refreshGcode();">Define XY Home</div>
          <div class="maslow-grid-item maslow-grid-item-btn"></div>
        </div>
        <div style="grid-template-columns: 80% 20%;" class="maslow-grid-container tablettab-controls-item" style="height: 60px;">
          <select class="form-control" id="filelist" onchange="selectFile()">
            <option>Load File...</option>
          </select>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #337ab7; color: white; height: 50px;display: flex;flex-direction: column;"
          onclick="files_select_upload()">
          <svg width="1.3em" height="1.2em" viewBox="0 0 1792 1792" fill="currentColor">
            <g>
              <path d="M1344 1472q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm256 0q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128-224v320q0 40-28 68t-68 28h-1472q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h427q21 56 70.5 92t110.5 36h256q61 0 110.5-36t70.5-92h427q40 0 68 28t28 68zm-325-648q-17 40-59 40h-256v448q0 26-19 45t-45 19h-256q-26 0-45-19t-19-45v-448h-256q-42 0-59-40-17-39 14-69l448-448q18-19 45-19t45 19l448 448q31 30 14 69z"/>
            </g>
          </svg>
          <span>Upload GCode</span>
          </div>
        </div>
        <div class="maslow-grid-container tablettab-controls-item" style="grid-template-columns: 33% 33% 33%;">
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #4aa85c;" onclick="doPlayButton()">
            <canvas id="playBtn" style="width: 100%; height: 100%"></canvas></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #efbb33;" onclick="doPauseButton()">
            <canvas id="pauseBtn" style="width: 100%; height: 100%"></canvas></div>
          <div class="maslow-grid-item maslow-grid-item-btn" style="background-color: #ce654c;"
            onclick="onCalibrationButtonsClick('$STOP','Stop Maslow and Gcode');"><canvas id="stopBtn"
              style="width: 100%; height: 100%"></canvas></div>
        </div>
        <div class="maslow-grid-container tablettab-controls-item" style="grid-template-columns: auto auto;">
          <div class="maslow-grid-item">
            <table style="width:100%">
              <tr>
                <td>X:</td>
                <td id="mpos-x">
                  0.000
                </td>
              </tr>
              <tr>
                <td>Y:</td>
                <td id="mpos-y">
                  0.000
                </td>
              </tr>
              <tr>
                <td>Z:</td>
                <td id="mpos-z">
                  0.000
                </td>
              </tr>
              <tr>
                <td id="active-state"></td>
              </tr>
            </table>
          </div>
          <div onclick="clearAlarm()" id="systemStatus" class="maslow-grid-item system-status">Idle</div>
        </div>
        <textarea style="border:  none" class="messages tablettab-controls-item" id="messages" rows="14" spellcheck="false" readonly>Serial Messages</textarea>
          <button onclick="saveSerialMessages()" class="btn btn-primary">Save Serial</button>
      </div>
    </div>

  </div>

    <div id="calibration-popup" class="calibration-modal-container" onclick="hideModal('calibration-popup')">
      <div class="calibration-modal-content" onclick="event.stopPropagation();">
          <div class="calibration-modal-button-container">
              <div class="buttons-row">
                <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$ALL','Retract All');">Retract All</button>
                <span class="arrow">&#8594;</span>
                <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$EXT','Extend All');">Extend All</button>
                <div class="buttons-row-col-el">
                  <span class="arrow">&#8599;</span>
                  <span class="arrow">&#8600;</span>
                </div>
                <div class="buttons-row-col-el">
                  <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$CAL','Calibrate'); hideModal('configuration-popup')">Calibrate</button>
                  <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$TKSLK','Apply Tension'); hideModal('configuration-popup')">Apply Tension</button>
                </div>


              </div>
              <div class="buttons-row">
                <!-- <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$TKSLK','Home Z');">Home Z</button> -->
                <button class="calibration-modal-button" onclick="loadConfigValues(); openModal('configuration-popup');">Config</button>
                <button class="calibration-modal-button stop-button" onclick="onCalibrationButtonsClick('$STOP','Stop');">Stop</button>
                <button
                  class="calibration-modal-button"
                  onclick="onCalibrationButtonsClick('$SETZSTOP','Set Z-Stop');"
                  title="Record the 'bottom' limit for Z-axis movement"
                >Set Z-Stop</button>
              </div>
              <div class="buttons-row">
                <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$TEST','Test');">Test</button>
                <button class="calibration-modal-button" onclick="onCalibrationButtonsClick('$CMP','Release Tension');">Release Tension</button>
              </div>

            </div>
      </div>
    </div>

    <div id="configuration-popup" class="calibration-modal-container" onclick="hideModal('configuration-popup')">
      <div class="calibration-modal-content" onclick="event.stopPropagation();">
        <div class="calibration-modal-button-container">
          <div class="input-row">
            <div style="display: flex; justify-content: center;">
              <label style="text-align: center;">Configuration</label>
            </div>
          </div>
          <hr style="border-top: 1px dashed;">
          <div class="grid-container">
            <div class="input-row">
              <label for="machineWidth" class="input-label">Machine Width(mm)</label>
            </div>
            <div class="input-row">
              <input id="machineWidth" type="text" class="calibration-modal-input">
            </div>
            <div class="input-row">
              <label for="machineHeight" class="input-label">Machine Height(mm)</label>
            </div>
            <div class="input-row">
              <input id="machineHeight" type="text" class="calibration-modal-input">
            </div>
            <div class="input-row">
              <label for="machineOrientation" class="input-label">Orientation</label>
            </div>
            <div class="input-row">
              <select id="machineOrientation" class="calibration-modal-input">
                <option value="horizontal">Horizontal</option>
                <option value="vertical">Vertical</option>
              </select>
            </div>
          </div>
          <hr style="border-top: 1px dashed;">
          <div class="input-row">
            <div style="display: flex; justify-content: center;">
              <label style="text-align: center;">Calibration Grid</label>
            </div>
          </div>
          <div class="grid-container">
            <div class="input-row">
              <label for="gridWidth" class="input-label">Width(mm)</label>
            </div>
            <div class="input-row">
              <input id="gridWidth" type="text" class="calibration-modal-input">
            </div>
            <div class="input-row">
              <label for="gridHeight" class="input-label">Height(mm)</label>
            </div>
            <div class="input-row">
              <input id="gridHeight" type="text" class="calibration-modal-input">
            </div>
            <div class="input-row">
              <label for="gridSize" class="input-label">Grid Size:</label>
            </div>
            <div class="input-row">
              <select id="gridSize" class="calibration-modal-input">
                <option value="3">3x3</option>
                <option value="5">5x5</option>
                <option value="7">7x7</option>
                <option value="9" selected>9x9</option>
              </select>
            </div>
          </div>
          <hr style="border-top: 1px dashed;">
          <div class="grid-container">
            <div class="input-row">
              <label for="retractionForce" class="input-label">Retraction Force</label>
            </div>
            <div class="input-row">
              <input id="retractionForce" type="text" class="calibration-modal-input">
            </div>
          </div>
          <hr style="border-top: 1px dashed;">
          <div class="input-row">
            <button type="button" class="calibration-modal-button" onclick="saveConfigValues();">Save</button>
          </div>
        </div>
      </div>
    </div>





